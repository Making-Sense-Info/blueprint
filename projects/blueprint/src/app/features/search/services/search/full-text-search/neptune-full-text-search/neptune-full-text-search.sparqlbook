[
  {
    "kind": 1,
    "language": "markdown",
    "value": "# Neptune Full Text Search",
    "metadata": {}
  },
  {
    "kind": 1,
    "language": "markdown",
    "value": "## Query without search Term\n\nThis is the query uses to fetch results without search term",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> \n  PREFIX blueprint: <https://flux.described.at/> \n  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> \n  PREFIX sh: <http://www.w3.org/ns/shacl#> \n  PREFIX fts: <http://aws.amazon.com/neptune/vocab/v01/services/fts#>\n  PREFIX xsd:  <http://www.w3.org/2001/XMLSchema#>\n  \n  CONSTRUCT\n  {\n    blueprint:query a blueprint:UiSearchResult ;\n        blueprint:result ?sub ;\n        blueprint:pageSize $pageSize;\n        blueprint:pageNumber $pageNumber. \n      ?sub a blueprint:UiSearchResultItem;\n          blueprint:score ?luScore ;\n          a ?bpClass ;\n          ?searchItemP ?searchItemO .\n          \n  }\n  WHERE\n  {\n    {\n      {\n        SELECT * WHERE {\n          {\n            SELECT ?sub ?luScore ?bpClass WHERE {\n              SERVICE fts:search {\n                fts:config fts:endpoint 'https://internal-opensearch-blueprint.aws.zazukoians.org' .\n                fts:config fts:queryType 'query_string' .\n                fts:config fts:field rdfs:label .\n                fts:config fts:field rdfs:comment .\n                fts:config fts:query \"in OR in*\" .\n                fts:config fts:return ?sub .\n                fts:config fts:maxResults 1000 .  \n                fts:config fts:minScore 0.9 .\n              }\n              ?sub a ?bpClass .\n              ?metaShape sh:targetNode ?bpClass .\n              ?metaShape a <https://ld.flux.zazuko.com/shapes/metadata/ClassMetadataShape> .\n              BIND (1 AS ?luScore)\n              FILTER (?bpClass = <http://example.org/ea/Attribute> || ?bpClass = <http://example.org/ea/Range> || ?bpClass = <http://schema.table.org/DatabaseSchema> || ?bpClass = <http://schema.table.org/Table> || ?bpClass = <http://schema.table.org/Column> || ?bpClass = <https://schema.ld.admin.ch/Canton> || ?bpClass = <http://schema.org/GovernmentOrganization> || ?bpClass = <http://schema.org/Person> || ?bpClass = <http://schema.org/SoftwareApplication> || ?bpClass = <http://example.org/ea/DataFlow> || ?bpClass = <http://example.org/ea/BusinessObject>)\n            }\n          }\n          VALUES ?searchItemP  {\n            rdfs:label\n            rdfs:comment\n          }\n          ?sub ?searchItemP ?searchItemO .\n        }\n        OFFSET  0\n        LIMIT   48\n      }\n    } UNION {\n      BIND (0 AS $pageNumber)\n      BIND (48 AS $pageSize)\n    }\n  }",
    "metadata": {}
  },
  {
    "kind": 1,
    "language": "markdown",
    "value": "# Search Query without search Term (select)\n",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> \n  PREFIX blueprint: <https://flux.described.at/> \n  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> \n  PREFIX sh: <http://www.w3.org/ns/shacl#> \n  PREFIX fts: <http://aws.amazon.com/neptune/vocab/v01/services/fts#>\n  PREFIX xsd:  <http://www.w3.org/2001/XMLSchema#>\n  \n  CONSTRUCT\n  {\n    blueprint:query a blueprint:UiSearchResult ;\n        blueprint:result ?sub ;\n        blueprint:pageSize $pageSize;\n        blueprint:pageNumber $pageNumber. \n      ?sub a blueprint:UiSearchResultItem;\n          blueprint:score ?score ;\n          ?searchItemP ?searchItemO .\n          \n  }\n  WHERE\n  {\n    {\n      {\n        SELECT * WHERE {\n          {\n            SELECT ?sub ?luScore WHERE {\n              SERVICE fts:search {\n                fts:config fts:endpoint 'https://internal-opensearch-blueprint.aws.zazukoians.org' .\n                fts:config fts:queryType 'query_string' .\n                fts:config fts:field rdfs:label .\n                fts:config fts:field rdfs:comment .\n                fts:config fts:query \"invent OR invent*\" .\n                fts:config fts:return ?sub .\n                fts:config fts:maxResults 1000 .  \n                fts:config fts:minScore 0.9 .\n              }\n              ?sub a ?bpClass .\n              ?metaShape sh:targetNode ?bpClass .\n              ?metaShape a <https://ld.flux.zazuko.com/shapes/metadata/ClassMetadataShape> .\n              BIND (1 AS ?luScore)\n              FILTER (?bpClass = <http://example.org/ea/Attribute> || ?bpClass = <http://example.org/ea/Range> || ?bpClass = <http://schema.table.org/DatabaseSchema> || ?bpClass = <http://schema.table.org/Table> || ?bpClass = <http://schema.table.org/Column> || ?bpClass = <https://schema.ld.admin.ch/Canton> || ?bpClass = <http://schema.org/GovernmentOrganization> || ?bpClass = <http://schema.org/Person> || ?bpClass = <http://schema.org/SoftwareApplication> || ?bpClass = <http://example.org/ea/DataFlow> || ?bpClass = <http://example.org/ea/BusinessObject>)\n            }\n          }\n          VALUES ?searchItemP  {\n            rdfs:label\n            rdfs:comment\n            rdf:type\n          }\n          ?sub ?searchItemP ?searchItemO .\n          BIND (1 AS ?score)  \n        }\n        OFFSET  0\n        LIMIT   48\n      }\n    } UNION {\n      BIND (0 AS $pageNumber)\n      BIND (48 AS $pageSize)\n    }\n  }",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "PREFIX  :     <https://flux.described.at/>\nPREFIX schema: <https://schema.org/>\nPREFIX rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX xsd:  <http://www.w3.org/2001/XMLSchema#>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX sh: <http://www.w3.org/ns/shacl#>\n\nSELECT * WHERE {\n    {\n      SELECT ?type WHERE {\n        ?shape a <https://ld.flux.zazuko.com/shapes/metadata/ClassMetadataShape> ;\n          sh:targetClass ?type .\n         FILTER(\n        ?type = <http://schema.example.org/BexioContact/latest/FluxClassInstance> \n        )  \n      }\n    }\n      ?sub a ?type;\n        rdfs:label ?label;\n        :searchPrio ?score.\n      OPTIONAL { ?sub rdfs:comment ?comment . }\n     \n    }\n    ORDER BY (?score)\n    OFFSET  0\n    LIMIT   50",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "  \n  \n  PREFIX  :     <https://flux.described.at/>\n  PREFIX fts: <tag:stardog:api:search:>\n  PREFIX schema: <https://schema.org/>\n  PREFIX rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n  PREFIX xsd:  <http://www.w3.org/2001/XMLSchema#>\n  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n  PREFIX sh: <http://www.w3.org/ns/shacl#>\n  #\n  #SELECT ?0_sub (SUM(?0_luceneScore) AS ?0_luScore) WHERE {\n  #          ?0_sub (rdfs:comment|rdfs:label) ?0_l.\n  #          SERVICE fts:textMatch {\n  #            [] fts:result ?0_l;\n  #              fts:query \"benjamin OR benjamin*\";\n  #              fts:score ?0_luceneScore.\n  #          }\n #         }\n #         GROUP BY ?0_sub\n    SELECT ?sub (SUM(?luceneScore) as ?luScore) WHERE {\n              ?sub (rdfs:label | rdfs:comment) ?l .\n              SERVICE fts:textMatch {\n                []  fts:result ?l ;\n                    fts:query \"benjamin OR benjamin*\" ;\n                    fts:score ?luceneScore .\n              }\n            }\n            GROUP BY ?sub\n ",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": " PREFIX  :     <https://flux.described.at/>\n  PREFIX fts: <tag:stardog:api:search:>\n  PREFIX schema: <https://schema.org/>\n  PREFIX rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n  PREFIX xsd:  <http://www.w3.org/2001/XMLSchema#>\n  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n  PREFIX sh: <http://www.w3.org/ns/shacl#>\n  PREFIX ex: <http://schema.example.org/>\n\n  SELECT *\n  WHERE\n  {\n    {\n      {\n        SELECT * WHERE {\n          {\n            SELECT ?sub (SUM(?luceneScore) as ?luScore) WHERE {\n              ?sub (rdfs:label | rdfs:comment) ?l .\n              SERVICE fts:textMatch {\n                []  fts:result ?l ;\n                    fts:query \"jonas bürgi OR jonas bürgi*\" ;\n                    fts:score ?luceneScore .\n              }\n            }\n            GROUP BY ?sub\n          }\n          \n          \n  {\n    BIND( <http://schema.example.org/BexioContact> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <http://schema.example.org/Repository> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <http://schema.example.org/Project> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://schema.org/Person> as ?fluxIri)\n    BIND( 4 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://ld.flux.zazuko.com/holacracy/Circle> as ?fluxIri)\n    BIND( 4 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://schema.org/Occupation> as ?fluxIri)\n    BIND( 4 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <http://schema.example.org/BexioProject> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://k8s.described.at/Cluster> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://k8s.described.at/Namespace> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://k8s.described.at/Ingress> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://k8s.described.at/Host> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://k8s.described.at/Deployment> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://k8s.described.at/StatefulSet> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://oci.described.at/Image> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://oci.described.at/Repository> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://oci.described.at/Registry> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  }\n  \n          BIND ((xsd:float(?searchPriority) * xsd:float(?luScore)) AS ?score)\n        }\n        ORDER BY DESC(?score)\n        OFFSET  0\n        LIMIT   50\n      }\n    } UNION {\n      BIND (0 AS $pageNumber)\n      BIND (50 AS $pageSize)\n    }\n  }",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": " PREFIX  :     <https://flux.described.at/>\n  PREFIX fts: <tag:stardog:api:search:>\n  PREFIX schema: <https://schema.org/>\n  PREFIX rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n  PREFIX xsd:  <http://www.w3.org/2001/XMLSchema#>\n  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n  PREFIX sh: <http://www.w3.org/ns/shacl#>\n  PREFIX ex: <http://schema.example.org/>\n\n  SELECT *\n  WHERE\n  {\n    {\n      {\n        SELECT ?sub (max(?ascore) as ?score) WHERE {\n          {\n            SELECT ?sub (SUM(?luceneScore) as ?luScore) WHERE {\n              ?sub (rdfs:label | rdfs:comment) ?l .\n              SERVICE fts:textMatch {\n                []  fts:result ?l ;\n                    fts:query \"jonas bürgi OR jonas bürgi*\" ;\n                    fts:score ?luceneScore .\n              }\n            }\n            GROUP BY ?sub\n          }\n          \n          \n  {\n    BIND( <http://schema.example.org/BexioContact> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <http://schema.example.org/Repository> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <http://schema.example.org/Project> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://schema.org/Person> as ?fluxIri)\n    BIND( 4 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://ld.flux.zazuko.com/holacracy/Circle> as ?fluxIri)\n    BIND( 4 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://schema.org/Occupation> as ?fluxIri)\n    BIND( 4 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <http://schema.example.org/BexioProject> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://k8s.described.at/Cluster> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://k8s.described.at/Namespace> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://k8s.described.at/Ingress> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://k8s.described.at/Host> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://k8s.described.at/Deployment> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://k8s.described.at/StatefulSet> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://oci.described.at/Image> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://oci.described.at/Repository> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  } UNION\n  {\n    BIND( <https://oci.described.at/Registry> as ?fluxIri)\n    BIND( 3 as ?searchPriority) \n\n    ?sub a ?fluxIri .\n    ?sub rdfs:label ?label .\n    OPTIONAL {\n      ?sub rdfs:comment ?comment .\n    }\n  }\n  \n          BIND ((xsd:float(?searchPriority) * xsd:float(?luScore)) AS ?ascore)\n        }\n        GROUP BY ?sub ?ascore\n        ORDER BY DESC(?score)\n        OFFSET  0\n        LIMIT   50\n      }\n    }\n    \n  }",
    "metadata": {}
  }
]